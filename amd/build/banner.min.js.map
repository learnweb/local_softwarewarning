{"version":3,"file":"banner.min.js","sources":["../src/banner.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Makes the banner closable\n *\n * @module     local_softwarewarning/banner\n * @copyright  2022 Justus Dieckmann WWU\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\nlet isenabled = true;\nlet iswwutheme = false;\nlet bannerparent;\nlet banner;\n\n// Theme wwu2019 stuff.\nlet fillelement;\nlet navbar;\n\n/**\n * Init\n */\nexport function init() {\n    iswwutheme = document.body.classList.contains('theme-wwu2019');\n    bannerparent = document.getElementById('banner-parent');\n    banner = bannerparent.querySelector('.softwarewarning-banner');\n    if (iswwutheme) {\n        fillelement = bannerparent.querySelector('.fill-element');\n        navbar = document.querySelector('nav#main-menu');\n    }\n    window.onresize = onResize;\n    // Setup close button.\n    const closebutton = document.querySelector('button.close[data-dismiss=\"banner\"]');\n    if (closebutton) {\n        closebutton.onclick = (e) => {\n            e.preventDefault();\n            isenabled = false;\n            document.getElementById('banner-parent').remove();\n            document.body.classList.remove('withbanner');\n            document.cookie = `disablebrowserwarn=true` +\n                `;path=${new URL(M.cfg.wwwroot).pathname};SameSite=strict`;\n            if (iswwutheme) {\n                navbar.style.top = null;\n            } else {\n                document.body.style.height = null;\n                document.body.style['-ms-transform'] = null;\n                document.body.style['-webkit-transform'] = null;\n                document.body.style['-moz-transform'] = null;\n                document.body.style.transform = null;\n            }\n        };\n    }\n    onResize();\n}\n\n/**\n * Does things on resize.\n */\nfunction onResize() {\n    if (!isenabled) {\n        return;\n    }\n    const height = banner.clientHeight;\n    if (iswwutheme) {\n        fillelement.style.height = height + 'px';\n        navbar.style.top = height + 'px';\n    } else {\n        document.body.style.height = `calc(100% - ${height}px)`;\n        document.body.style['-ms-transform'] = `translateY(${height}px)`;\n        document.body.style['-webkit-transform'] = `translateY(${height}px)`;\n        document.body.style['-moz-transform'] = `translateY(${height}px)`;\n        document.body.style.transform = `translateY(${height}px)`;\n        bannerparent.style['-ms-transform'] = `translateY(-${height}px)`;\n        bannerparent.style['-webkit-transform'] = `translateY(-${height}px)`;\n        bannerparent.style['-moz-transform'] = `translateY(-${height}px)`;\n        bannerparent.style.transform = `translateY(-${height}px)`;\n    }\n}"],"names":["iswwutheme","document","body","classList","contains","bannerparent","getElementById","banner","querySelector","fillelement","navbar","window","onresize","onResize","closebutton","onclick","e","preventDefault","isenabled","remove","cookie","URL","M","cfg","wwwroot","pathname","style","top","height","transform","clientHeight"],"mappings":"uJAmCIA,WAAaC,SAASC,KAAKC,UAAUC,SAAS,iBAC9CC,aAAeJ,SAASK,eAAe,iBACvCC,OAASF,aAAaG,cAAc,2BAChCR,aACAS,YAAcJ,aAAaG,cAAc,iBACzCE,OAAST,SAASO,cAAc,kBAEpCG,OAAOC,SAAWC,eAEZC,YAAcb,SAASO,cAAc,uCACvCM,cACAA,YAAYC,QAAWC,IACnBA,EAAEC,iBACFC,WAAY,EACZjB,SAASK,eAAe,iBAAiBa,SACzClB,SAASC,KAAKC,UAAUgB,OAAO,cAC/BlB,SAASmB,OAAS,0CACL,IAAIC,IAAIC,EAAEC,IAAIC,SAASC,6BAChCzB,WACAU,OAAOgB,MAAMC,IAAM,MAEnB1B,SAASC,KAAKwB,MAAME,OAAS,KAC7B3B,SAASC,KAAKwB,MAAM,iBAAmB,KACvCzB,SAASC,KAAKwB,MAAM,qBAAuB,KAC3CzB,SAASC,KAAKwB,MAAM,kBAAoB,KACxCzB,SAASC,KAAKwB,MAAMG,UAAY,QAI5ChB;;;;;;;;IAxCAR,aACAE,OAGAE,YACAC,OAPAQ,WAAY,EACZlB,YAAa,WA+CRa,eACAK,uBAGCU,OAASrB,OAAOuB,aAClB9B,YACAS,YAAYiB,MAAME,OAASA,OAAS,KACpClB,OAAOgB,MAAMC,IAAMC,OAAS,OAE5B3B,SAASC,KAAKwB,MAAME,6BAAwBA,cAC5C3B,SAASC,KAAKwB,MAAM,sCAAiCE,cACrD3B,SAASC,KAAKwB,MAAM,0CAAqCE,cACzD3B,SAASC,KAAKwB,MAAM,uCAAkCE,cACtD3B,SAASC,KAAKwB,MAAMG,+BAA0BD,cAC9CvB,aAAaqB,MAAM,uCAAkCE,cACrDvB,aAAaqB,MAAM,2CAAsCE,cACzDvB,aAAaqB,MAAM,wCAAmCE,cACtDvB,aAAaqB,MAAMG,gCAA2BD"}